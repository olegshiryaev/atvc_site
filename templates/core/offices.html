{% extends 'base.html' %}
{% load static %}

{% block title %}Офисы обслуживания{% endblock %}

{% block content %}
<div class="offices-page">
    <div class="container">
        {% include 'partials/page_header.html' with title=title %}
        
        <!-- Фильтр по городам -->
        <div class="offices-filter">
            <div class="offices-filter__scroller">
                <div class="offices-filter__nav" role="tablist">
                    {% for locality in localities %}
                    <button class="offices-filter__btn {% if locality == current_locality %}active{% endif %}"
                            data-target="#office-city-{{ locality.slug }}"
                            role="tab"
                            aria-controls="office-city-{{ locality.slug }}"
                            aria-selected="{% if locality == current_locality %}true{% else %}false{% endif %}"
                            data-locality-slug="{{ locality.slug }}">
                        {{ locality.name }}
                    </button>
                    {% endfor %}
                </div>
            </div>
        </div>

        <!-- Контент офисов -->
        <div class="offices-content">
            {% for locality in localities %}
            <div class="offices-city {% if locality == current_locality %}active{% endif %}" 
                 id="office-city-{{ locality.slug }}"
                 role="tabpanel">
                 
                {% for office in locality.office_set.all %}
                <div class="office-card">
                    <!-- Левая колонка - контакты -->
                    <div class="office-contacts">
                        <div class="office-detail">
                            <div class="office-detail__title">По любым вопросам пишите нам:</div>
                            <div class="office-detail__value">
                                <a href="https://vk.com/yourcompany" target="_blank">
                                    <i class="fab fa-vk"></i> ВКонтакте
                                </a>
                            </div>
                        </div>
                        
                        <div class="office-detail">
                            <div class="office-detail__title">Или на почту</div>
                            <div class="office-detail__value">
                                <a href="mailto:dom@uut-telecom.ru">
                                    <i class="fas fa-envelope"></i> dom@uut-telecom.ru
                                </a>
                            </div>
                        </div>
                        
                        {% if office.phone %}
                        <div class="office-detail">
                            <div class="office-detail__title">Или звоните</div>
                            <div class="office-detail__value">
                                <a href="tel:{{ office.phone }}">
                                    <i class="fas fa-phone"></i> {{ office.phone }}
                                </a>
                            </div>
                        </div>
                        {% endif %}
                        
                        <div class="office-detail">
                            <div class="office-detail__title">Подписывайтесь на наши соцсети</div>
                            <div class="social-links">
                                <a href="#"><i class="fab fa-vk"></i></a>
                                <a href="#"><i class="fab fa-telegram"></i></a>
                                <a href="#"><i class="fab fa-youtube"></i></a>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Правая колонка - адрес и карта -->
                    <div class="office-map-card">
                        <div class="office-address">
                            <i class="fas fa-location-dot"></i> {{ office.address }}
                        </div>
                        
                        <div class="office-hours">
                            <i class="fas fa-clock"></i> 
                            {% for schedule in office.schedules.all %}
                                {{ schedule.days }}: 
                                {% if schedule.is_closed %}выходной
                                {% else %}{{ schedule.start_time|time:"H:i" }}–{{ schedule.end_time|time:"H:i" }}
                                {% endif %}<br>
                            {% endfor %}
                        </div>
                        
                        <a href="https://yandex.ru/maps/?pt={{ office.longitude }},{{ office.latitude }}&z=16" 
                           class="map-button" target="_blank">
                            Открыть в Яндекс Картах
                        </a>
                        
                        <a href="#" class="feedback-button">Оставить отзыв</a>
                        
                        <div class="office-map">
                            <iframe loading="lazy" width="100%" height="100%" frameborder="0"
                                    src="https://yandex.ru/map-widget/v1/?ll={{ office.longitude }},{{ office.latitude }}&z=16&pt={{ office.longitude }},{{ office.latitude }}"
                                    allowfullscreen="true"></iframe>
                        </div>
                    </div>
                </div>
                {% empty %}
                <p class="offices-empty">Офисы в этом городе не найдены</p>
                {% endfor %}
            </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}